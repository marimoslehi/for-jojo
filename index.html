<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚ú® For Jojo ‚ú®</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&family=Sacramento&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #0a0a12;
    overflow-x: hidden;
    cursor: default;
    font-family: 'Cormorant Garamond', serif;
  }

  /* Custom cursor trail */
  .cursor-glow {
    position: fixed;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255,180,120,0.6), transparent);
    pointer-events: none;
    z-index: 9999;
    transform: translate(-50%, -50%);
    transition: opacity 0.3s;
  }

  /* ============ STARFIELD CANVAS ============ */
  #starfield {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 0;
  }

  /* ============ FIREFLY CANVAS ============ */
  #fireflies {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 1;
    pointer-events: none;
  }

  /* ============ CONTENT ============ */
  .content {
    position: relative;
    z-index: 2;
    min-height: 100vh;
  }

  /* ============ SCENE 1: INTRO ============ */
  .scene-intro {
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  .intro-greeting {
    font-family: 'Sacramento', cursive;
    font-size: clamp(2rem, 6vw, 4.5rem);
    color: transparent;
    background: linear-gradient(135deg, #f9d29d, #f4a261, #e76f51, #f9d29d);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    background-clip: text;
    animation: shimmer 4s ease infinite, fadeSlideUp 2s ease forwards;
    opacity: 0;
    letter-spacing: 2px;
  }

  .intro-name {
    font-family: 'Playfair Display', serif;
    font-size: clamp(4rem, 12vw, 10rem);
    font-weight: 700;
    color: transparent;
    background: linear-gradient(135deg, #ffecd2, #fcb69f, #ff9a9e, #ffecd2);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    background-clip: text;
    animation: shimmer 3s ease infinite;
    opacity: 0;
    animation: shimmer 3s ease infinite, fadeSlideUp 2s 0.6s ease forwards;
    text-shadow: 0 0 80px rgba(252,182,159,0.3);
    letter-spacing: 4px;
  }

  .intro-line {
    width: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, #f4a261, transparent);
    margin: 20px 0;
    animation: expandLine 2s 1.2s ease forwards;
  }

  .intro-sub {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(1rem, 2.5vw, 1.5rem);
    color: #c4a882;
    font-style: italic;
    font-weight: 300;
    opacity: 0;
    animation: fadeSlideUp 2s 1.6s ease forwards;
    letter-spacing: 4px;
    text-transform: lowercase;
  }

  .scroll-hint {
    position: absolute;
    bottom: 40px;
    opacity: 0;
    animation: fadeIn 1s 3s forwards, bounce 2s 3s infinite;
    color: #666;
    font-size: 0.9rem;
    letter-spacing: 3px;
    text-transform: uppercase;
  }

  .scroll-hint::after {
    content: '';
    display: block;
    width: 1px;
    height: 30px;
    background: linear-gradient(to bottom, #666, transparent);
    margin: 10px auto 0;
    animation: scrollLine 2s infinite;
  }

  /* ============ SCENE 2: CONSTELLATION ============ */
  .scene-constellation {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
    position: relative;
  }

  .constellation-wrapper {
    text-align: center;
    opacity: 0;
    transform: translateY(40px);
    transition: all 1.5s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .constellation-wrapper.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .constellation-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(1.2rem, 3vw, 2rem);
    color: #d4b896;
    font-weight: 300;
    line-height: 2.2;
    max-width: 600px;
    margin: 0 auto;
  }

  .constellation-text .highlight {
    color: #f4a261;
    font-family: 'Sacramento', cursive;
    font-size: 1.6em;
    position: relative;
  }

  .constellation-text .highlight::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 100%;
    height: 1px;
    background: linear-gradient(90deg, transparent, #f4a261, transparent);
    animation: pulse 2s infinite;
  }

  /* ============ SCENE 3: TYPING CODE ============ */
  .scene-code {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
  }

  .code-card {
    background: linear-gradient(145deg, #12121e, #1a1a2e);
    border: 1px solid rgba(255,180,120,0.1);
    border-radius: 16px;
    padding: 40px;
    max-width: 580px;
    width: 100%;
    box-shadow:
      0 0 60px rgba(244,162,97,0.05),
      inset 0 1px 0 rgba(255,255,255,0.03);
    opacity: 0;
    transform: translateY(40px) scale(0.95);
    transition: all 1.5s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .code-card.visible {
    opacity: 1;
    transform: translateY(0) scale(1);
  }

  .code-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid rgba(255,255,255,0.06);
  }

  .code-dot {
    width: 12px; height: 12px;
    border-radius: 50%;
  }
  .code-dot:nth-child(1) { background: #ff5f57; }
  .code-dot:nth-child(2) { background: #febc2e; }
  .code-dot:nth-child(3) { background: #28c840; }

  .code-filename {
    margin-left: 12px;
    color: #666;
    font-family: 'Courier New', monospace;
    font-size: 0.8rem;
  }

  .code-body {
    font-family: 'Courier New', monospace;
    font-size: clamp(0.75rem, 1.8vw, 0.95rem);
    line-height: 1.9;
    color: #888;
  }

  .code-body .keyword { color: #c792ea; }
  .code-body .func { color: #82aaff; }
  .code-body .string { color: #c3e88d; }
  .code-body .comment { color: #546e7a; font-style: italic; }
  .code-body .variable { color: #f78c6c; }
  .code-body .operator { color: #89ddff; }
  .code-body .special { color: #f4a261; font-weight: bold; }
  .code-body .heart { color: #ff6b81; }

  .code-line {
    opacity: 0;
    transform: translateX(-10px);
    white-space: pre;
  }

  .code-line.typed {
    opacity: 1;
    transform: translateX(0);
    transition: all 0.4s ease;
  }

  .cursor-blink {
    display: inline-block;
    width: 2px;
    height: 1.1em;
    background: #f4a261;
    vertical-align: text-bottom;
    animation: blink 1s step-end infinite;
  }

  /* ============ SCENE 4: INTERACTIVE STARS ============ */
  .scene-stars {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
    position: relative;
  }

  .stars-prompt {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(1.1rem, 2.5vw, 1.6rem);
    color: #a08a6e;
    font-style: italic;
    margin-bottom: 40px;
    opacity: 0;
    transition: all 1.5s ease;
    text-align: center;
  }

  .stars-prompt.visible { opacity: 1; }

  #interactive-canvas {
    border-radius: 16px;
    cursor: crosshair;
    opacity: 0;
    transition: opacity 1.5s ease;
    max-width: 100%;
  }

  #interactive-canvas.visible { opacity: 1; }

  .stars-note {
    font-family: 'Cormorant Garamond', serif;
    font-size: 0.9rem;
    color: #555;
    margin-top: 16px;
    opacity: 0;
    transition: all 1.5s ease 0.5s;
    letter-spacing: 2px;
  }
  .stars-note.visible { opacity: 1; }

  /* ============ SCENE 5: FINALE ============ */
  .scene-finale {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
    position: relative;
  }

  .finale-text {
    font-family: 'Sacramento', cursive;
    font-size: clamp(3rem, 8vw, 6rem);
    color: transparent;
    background: linear-gradient(135deg, #ffecd2, #fcb69f, #ff9a9e, #fad0c4, #ffecd2);
    background-size: 400% 400%;
    -webkit-background-clip: text;
    background-clip: text;
    animation: shimmer 4s ease infinite;
    opacity: 0;
    transition: all 2s ease;
    text-align: center;
    line-height: 1.3;
  }

  .finale-text.visible { opacity: 1; }

  .finale-sub {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(1rem, 2vw, 1.3rem);
    color: #8a7a66;
    font-style: italic;
    margin-top: 20px;
    opacity: 0;
    transition: all 2s ease 0.8s;
    letter-spacing: 3px;
  }
  .finale-sub.visible { opacity: 1; }

  .heart-rain {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
    z-index: 10;
    opacity: 0;
    transition: opacity 1s ease;
  }
  .heart-rain.active { opacity: 1; }

  .floating-heart {
    position: absolute;
    font-size: 1.2rem;
    opacity: 0;
    animation: heartFall linear forwards;
    color: #f4a261;
  }

  /* ============ KEYFRAMES ============ */
  @keyframes shimmer {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }

  @keyframes fadeSlideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes expandLine {
    to { width: min(300px, 60vw); }
  }

  @keyframes fadeIn {
    to { opacity: 1; }
  }

  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(8px); }
  }

  @keyframes scrollLine {
    0% { opacity: 1; transform: scaleY(1); }
    100% { opacity: 0; transform: scaleY(0.3); transform-origin: top; }
  }

  @keyframes blink {
    50% { opacity: 0; }
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 1; }
  }

  @keyframes heartFall {
    0% { opacity: 0; transform: translateY(-20px) rotate(0deg) scale(0.5); }
    10% { opacity: 1; }
    90% { opacity: 0.8; }
    100% { opacity: 0; transform: translateY(100vh) rotate(360deg) scale(1); }
  }

  /* Ambient glow orbs */
  .ambient-orb {
    position: fixed;
    border-radius: 50%;
    filter: blur(80px);
    pointer-events: none;
    z-index: 0;
    opacity: 0.15;
  }

  .orb-1 {
    width: 400px; height: 400px;
    background: radial-gradient(circle, #f4a261, transparent);
    top: -100px; right: -100px;
    animation: orbFloat1 12s ease-in-out infinite;
  }

  .orb-2 {
    width: 300px; height: 300px;
    background: radial-gradient(circle, #e76f51, transparent);
    bottom: -50px; left: -50px;
    animation: orbFloat2 15s ease-in-out infinite;
  }

  .orb-3 {
    width: 250px; height: 250px;
    background: radial-gradient(circle, #fcb69f, transparent);
    top: 50%; left: 50%;
    animation: orbFloat3 18s ease-in-out infinite;
  }

  @keyframes orbFloat1 {
    0%, 100% { transform: translate(0, 0); }
    33% { transform: translate(-60px, 80px); }
    66% { transform: translate(40px, -30px); }
  }

  @keyframes orbFloat2 {
    0%, 100% { transform: translate(0, 0); }
    33% { transform: translate(80px, -60px); }
    66% { transform: translate(-30px, 40px); }
  }

  @keyframes orbFloat3 {
    0%, 100% { transform: translate(-50%, -50%); }
    33% { transform: translate(-30%, -70%); }
    66% { transform: translate(-70%, -30%); }
  }

  /* ============ SECRET MESSAGE ============ */
  .secret-trigger {
    cursor: pointer;
    position: relative;
    transition: all 0.3s ease;
  }

  .secret-trigger:hover {
    text-shadow: 0 0 20px rgba(244,162,97,0.5);
  }

  .secret-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(5, 5, 15, 0);
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    transition: background 1.5s ease;
  }

  .secret-overlay.revealed {
    background: rgba(5, 5, 15, 0.95);
    pointer-events: all;
  }

  .secret-content {
    text-align: center;
    opacity: 0;
    transform: scale(0.8);
    transition: all 1.5s cubic-bezier(0.16, 1, 0.3, 1) 0.3s;
  }

  .secret-overlay.revealed .secret-content {
    opacity: 1;
    transform: scale(1);
  }

  .secret-emoji {
    font-size: 3rem;
    margin-bottom: 24px;
    animation: none;
  }

  .secret-overlay.revealed .secret-emoji {
    animation: secretPulse 2s ease infinite;
  }

  .secret-msg {
    font-family: 'Sacramento', cursive;
    font-size: clamp(2rem, 5vw, 3.5rem);
    color: transparent;
    background: linear-gradient(135deg, #ffecd2, #f4a261, #fcb69f, #ffecd2);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    background-clip: text;
    animation: shimmer 3s ease infinite;
    line-height: 1.5;
    max-width: 500px;
    padding: 0 20px;
  }

  .secret-hint {
    font-family: 'Cormorant Garamond', serif;
    font-size: 0.85rem;
    color: #554a3a;
    margin-top: 30px;
    letter-spacing: 3px;
    text-transform: uppercase;
    opacity: 0;
    transition: opacity 1.5s ease 1.5s;
  }

  .secret-overlay.revealed .secret-hint {
    opacity: 1;
  }

  .secret-close {
    position: absolute;
    top: 30px;
    right: 30px;
    color: #555;
    font-size: 1.5rem;
    cursor: pointer;
    opacity: 0;
    transition: opacity 1s ease 1s, color 0.3s;
    font-family: 'Cormorant Garamond', serif;
  }

  .secret-overlay.revealed .secret-close {
    opacity: 1;
  }

  .secret-close:hover {
    color: #f4a261;
  }

  .secret-sparkle {
    position: absolute;
    width: 4px; height: 4px;
    background: #f4a261;
    border-radius: 50%;
    pointer-events: none;
    animation: sparkleFloat 1.5s ease forwards;
  }

  @keyframes secretPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.15); }
  }

  @keyframes sparkleFloat {
    0% { opacity: 1; transform: translate(0, 0) scale(1); }
    100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0); }
  }

  /* Click counter hint */
  .click-counter-hint {
    position: fixed;
    bottom: 20px;
    right: 20px;
    font-family: 'Cormorant Garamond', serif;
    font-size: 0.75rem;
    color: #2a2a2a;
    letter-spacing: 2px;
    z-index: 5;
    transition: color 0.5s;
  }

  /* Mobile tweaks */
  @media (max-width: 600px) {
    .code-card { padding: 24px 16px; }
  }
</style>
</head>
<body>

<!-- Ambient orbs -->
<div class="ambient-orb orb-1"></div>
<div class="ambient-orb orb-2"></div>
<div class="ambient-orb orb-3"></div>

<!-- Background canvases -->
<canvas id="starfield"></canvas>
<canvas id="fireflies"></canvas>

<!-- Cursor glow -->
<div class="cursor-glow" id="cursorGlow"></div>

<!-- Heart rain container -->
<div class="heart-rain" id="heartRain"></div>

<!-- Main content -->
<div class="content">

  <!-- SCENE 1: Intro -->
  <section class="scene-intro">
    <div class="intro-greeting">hey there,</div>
    <div class="intro-name">Jojo</div>
    <div class="intro-line"></div>
    <div class="intro-sub">something i made for you</div>
    <div class="scroll-hint">scroll</div>
  </section>

  <!-- SCENE 2: Constellation Message -->
  <section class="scene-constellation">
    <div class="constellation-wrapper" data-reveal>
      <p class="constellation-text">
        If I could write an algorithm<br>
        to map every <span class="highlight">constellation</span><br>
        in the night sky,<br><br>
        I'd still run out of stars<br>
        before I could count all the reasons<br>
        you make me <span class="highlight">smile</span>
      </p>
    </div>
  </section>

  <!-- SCENE 3: Code Block -->
  <section class="scene-code">
    <div class="code-card" data-reveal>
      <div class="code-header">
        <div class="code-dot"></div>
        <div class="code-dot"></div>
        <div class="code-dot"></div>
        <span class="code-filename">jojo.py</span>
      </div>
      <div class="code-body" id="codeBlock">
        <div class="code-line" data-delay="0"><span class="comment"># the only program that matters</span></div>
        <div class="code-line" data-delay="200"></div>
        <div class="code-line" data-delay="400"><span class="keyword">class</span> <span class="func">Jojo</span>:</div>
        <div class="code-line" data-delay="600">    <span class="variable">smile</span> <span class="operator">=</span> <span class="string">"infectious"</span></div>
        <div class="code-line" data-delay="800">    <span class="variable">vibe</span> <span class="operator">=</span> <span class="string">"unmatched"</span></div>
        <div class="code-line" data-delay="1000">    <span class="variable">effect_on_me</span> <span class="operator">=</span> <span class="string">"can't stop thinking"</span></div>
        <div class="code-line" data-delay="1200"></div>
        <div class="code-line" data-delay="1400">    <span class="keyword">def</span> <span class="func">exist</span>(<span class="variable">self</span>):</div>
        <div class="code-line" data-delay="1600">        <span class="keyword">return</span> <span class="string">"makes everything better"</span></div>
        <div class="code-line" data-delay="1800"></div>
        <div class="code-line" data-delay="2000"><span class="comment"># running this on a loop forever</span></div>
        <div class="code-line" data-delay="2200"><span class="keyword">while</span> <span class="special">True</span>:</div>
        <div class="code-line" data-delay="2400">    <span class="func">think_about</span>(Jojo) <span class="heart secret-trigger" id="secretTrigger" title="..."># ‚ô•</span></div>
        <div class="code-line" data-delay="2600">    <span class="variable">my_day</span> <span class="operator">=</span> <span class="string">"better"</span><span class="cursor-blink"></span></div>
      </div>
    </div>
  </section>

  <!-- SCENE 4: Interactive Canvas -->
  <section class="scene-stars">
    <p class="stars-prompt" data-reveal>tap anywhere to leave your mark on our sky</p>
    <canvas id="interactive-canvas" width="500" height="400" data-reveal></canvas>
    <p class="stars-note" data-reveal>every click creates a constellation just for you</p>
  </section>

  <!-- SCENE 5: Finale -->
  <section class="scene-finale">
    <div class="finale-text" data-reveal>You're my favorite<br>notification</div>
    <div class="finale-sub" data-reveal>‚Äî always worth the click</div>
  </section>

</div>

<!-- Secret Message Overlay -->
<div class="secret-overlay" id="secretOverlay">
  <span class="secret-close" id="secretClose">‚úï</span>
  <div class="secret-content">
    <div class="secret-emoji">üîê</div>
    <div class="secret-msg">You found it, Jojo.<br><br>This whole thing was just an excuse to tell you...<br>you're the sweetest bug in my code.</div>
    <div class="secret-hint">you were curious enough to click ‚Äî i like that about you</div>
  </div>
</div>

<!-- Subtle hint -->
<div class="click-counter-hint" id="clickHint"></div>

<script>
// ============ STARFIELD ============
const starCanvas = document.getElementById('starfield');
const starCtx = starCanvas.getContext('2d');
let stars = [];

function resizeStarfield() {
  starCanvas.width = window.innerWidth;
  starCanvas.height = window.innerHeight;
  stars = [];
  for (let i = 0; i < 200; i++) {
    stars.push({
      x: Math.random() * starCanvas.width,
      y: Math.random() * starCanvas.height,
      r: Math.random() * 1.5 + 0.3,
      alpha: Math.random(),
      speed: Math.random() * 0.005 + 0.002
    });
  }
}

function drawStars() {
  starCtx.clearRect(0, 0, starCanvas.width, starCanvas.height);
  stars.forEach(s => {
    s.alpha += Math.sin(Date.now() * s.speed) * 0.01;
    s.alpha = Math.max(0.1, Math.min(1, s.alpha));
    starCtx.beginPath();
    starCtx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
    starCtx.fillStyle = `rgba(255, 230, 200, ${s.alpha * 0.6})`;
    starCtx.fill();
  });
  requestAnimationFrame(drawStars);
}

resizeStarfield();
drawStars();
window.addEventListener('resize', resizeStarfield);

// ============ FIREFLIES ============
const ffCanvas = document.getElementById('fireflies');
const ffCtx = ffCanvas.getContext('2d');
let fireflies = [];

function resizeFireflies() {
  ffCanvas.width = window.innerWidth;
  ffCanvas.height = window.innerHeight;
  fireflies = [];
  for (let i = 0; i < 30; i++) {
    fireflies.push({
      x: Math.random() * ffCanvas.width,
      y: Math.random() * ffCanvas.height,
      vx: (Math.random() - 0.5) * 0.5,
      vy: (Math.random() - 0.5) * 0.5,
      r: Math.random() * 3 + 1,
      phase: Math.random() * Math.PI * 2,
      color: Math.random() > 0.5 ? [244, 162, 97] : [252, 182, 159]
    });
  }
}

function drawFireflies() {
  ffCtx.clearRect(0, 0, ffCanvas.width, ffCanvas.height);
  const t = Date.now() * 0.001;
  fireflies.forEach(f => {
    f.x += f.vx + Math.sin(t + f.phase) * 0.3;
    f.y += f.vy + Math.cos(t + f.phase) * 0.3;
    if (f.x < 0) f.x = ffCanvas.width;
    if (f.x > ffCanvas.width) f.x = 0;
    if (f.y < 0) f.y = ffCanvas.height;
    if (f.y > ffCanvas.height) f.y = 0;
    const glow = (Math.sin(t * 2 + f.phase) + 1) / 2 * 0.5 + 0.2;
    const [r, g, b] = f.color;
    ffCtx.beginPath();
    const grad = ffCtx.createRadialGradient(f.x, f.y, 0, f.x, f.y, f.r * 6);
    grad.addColorStop(0, `rgba(${r},${g},${b},${glow})`);
    grad.addColorStop(1, `rgba(${r},${g},${b},0)`);
    ffCtx.fillStyle = grad;
    ffCtx.arc(f.x, f.y, f.r * 6, 0, Math.PI * 2);
    ffCtx.fill();
    ffCtx.beginPath();
    ffCtx.arc(f.x, f.y, f.r * 0.8, 0, Math.PI * 2);
    ffCtx.fillStyle = `rgba(255,240,220,${glow})`;
    ffCtx.fill();
  });
  requestAnimationFrame(drawFireflies);
}

resizeFireflies();
drawFireflies();
window.addEventListener('resize', resizeFireflies);

// ============ CURSOR GLOW ============
const cursorGlow = document.getElementById('cursorGlow');
document.addEventListener('mousemove', e => {
  cursorGlow.style.left = e.clientX + 'px';
  cursorGlow.style.top = e.clientY + 'px';
  cursorGlow.style.opacity = '1';
});
document.addEventListener('mouseleave', () => {
  cursorGlow.style.opacity = '0';
});

// ============ SCROLL REVEAL ============
const revealElements = document.querySelectorAll('[data-reveal]');
const codeCard = document.querySelector('.code-card');
let codeAnimated = false;

const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');

      // Trigger code typing animation
      if (entry.target === codeCard && !codeAnimated) {
        codeAnimated = true;
        animateCode();
      }

      // Trigger heart rain on finale
      if (entry.target.classList.contains('finale-text')) {
        triggerHeartRain();
      }
    }
  });
}, { threshold: 0.3 });

revealElements.forEach(el => observer.observe(el));

// ============ CODE TYPING ANIMATION ============
function animateCode() {
  const lines = document.querySelectorAll('.code-line');
  lines.forEach((line, i) => {
    const delay = parseInt(line.dataset.delay) || 0;
    setTimeout(() => {
      line.classList.add('typed');
    }, delay);
  });
}

// ============ INTERACTIVE CONSTELLATION CANVAS ============
const iCanvas = document.getElementById('interactive-canvas');
const iCtx = iCanvas.getContext('2d');
let constellationPoints = [];
let sparkles = [];

function resizeInteractive() {
  const w = Math.min(500, window.innerWidth - 40);
  iCanvas.width = w;
  iCanvas.height = w * 0.8;
  redrawConstellation();
}
resizeInteractive();
window.addEventListener('resize', resizeInteractive);

// Fill bg
function redrawConstellation() {
  const w = iCanvas.width, h = iCanvas.height;
  iCtx.fillStyle = '#0d0d1a';
  iCtx.fillRect(0, 0, w, h);

  // Mini stars
  for (let i = 0; i < 80; i++) {
    iCtx.beginPath();
    iCtx.arc(Math.random() * w, Math.random() * h, Math.random() * 0.8 + 0.2, 0, Math.PI * 2);
    iCtx.fillStyle = `rgba(255,230,200,${Math.random() * 0.3 + 0.1})`;
    iCtx.fill();
  }

  // Draw lines between nearby points
  for (let i = 0; i < constellationPoints.length; i++) {
    for (let j = i + 1; j < constellationPoints.length; j++) {
      const a = constellationPoints[i], b = constellationPoints[j];
      const dist = Math.hypot(a.x - b.x, a.y - b.y);
      if (dist < 120) {
        iCtx.beginPath();
        iCtx.moveTo(a.x, a.y);
        iCtx.lineTo(b.x, b.y);
        const alpha = 1 - dist / 120;
        iCtx.strokeStyle = `rgba(244,162,97,${alpha * 0.4})`;
        iCtx.lineWidth = 0.8;
        iCtx.stroke();
      }
    }
  }

  // Draw points
  constellationPoints.forEach(p => {
    // Glow
    const grad = iCtx.createRadialGradient(p.x, p.y, 0, p.x, p.y, 12);
    grad.addColorStop(0, `rgba(${p.color},0.6)`);
    grad.addColorStop(1, 'rgba(244,162,97,0)');
    iCtx.fillStyle = grad;
    iCtx.beginPath();
    iCtx.arc(p.x, p.y, 12, 0, Math.PI * 2);
    iCtx.fill();

    // Core
    iCtx.beginPath();
    iCtx.arc(p.x, p.y, 3, 0, Math.PI * 2);
    iCtx.fillStyle = `rgba(255,240,220,0.9)`;
    iCtx.fill();
  });
}

iCanvas.addEventListener('click', e => {
  const rect = iCanvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  const colors = ['255,200,150', '244,162,97', '252,182,159', '255,154,158'];
  constellationPoints.push({
    x, y,
    color: colors[Math.floor(Math.random() * colors.length)]
  });
  redrawConstellation();
});

// Touch support
iCanvas.addEventListener('touchstart', e => {
  e.preventDefault();
  const rect = iCanvas.getBoundingClientRect();
  const touch = e.touches[0];
  const x = touch.clientX - rect.left;
  const y = touch.clientY - rect.top;
  const colors = ['255,200,150', '244,162,97', '252,182,159', '255,154,158'];
  constellationPoints.push({
    x, y,
    color: colors[Math.floor(Math.random() * colors.length)]
  });
  redrawConstellation();
});

// ============ HEART RAIN ============
function triggerHeartRain() {
  const container = document.getElementById('heartRain');
  container.classList.add('active');
  const hearts = ['‚ô•', '‚ô°', '‚ú¶', '¬∑'];
  for (let i = 0; i < 40; i++) {
    setTimeout(() => {
      const heart = document.createElement('span');
      heart.className = 'floating-heart';
      heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
      heart.style.left = Math.random() * 100 + 'vw';
      heart.style.fontSize = (Math.random() * 1.2 + 0.6) + 'rem';
      heart.style.animationDuration = (Math.random() * 4 + 3) + 's';
      heart.style.color = `hsl(${25 + Math.random() * 15}, ${70 + Math.random() * 30}%, ${65 + Math.random() * 20}%)`;
      container.appendChild(heart);
      setTimeout(() => heart.remove(), 7000);
    }, i * 150);
  }
}

redrawConstellation();

// ============ SECRET MESSAGE ============
const secretTrigger = document.getElementById('secretTrigger');
const secretOverlay = document.getElementById('secretOverlay');
const secretClose = document.getElementById('secretClose');
const clickHint = document.getElementById('clickHint');
let secretClicks = 0;
const CLICKS_NEEDED = 3;

secretTrigger.addEventListener('click', (e) => {
  e.stopPropagation();
  secretClicks++;
  
  // Sparkle effect on click
  for (let i = 0; i < 6; i++) {
    const sparkle = document.createElement('div');
    sparkle.className = 'secret-sparkle';
    const angle = (Math.PI * 2 / 6) * i;
    const dist = 30 + Math.random() * 20;
    sparkle.style.setProperty('--tx', Math.cos(angle) * dist + 'px');
    sparkle.style.setProperty('--ty', Math.sin(angle) * dist + 'px');
    sparkle.style.left = e.clientX + 'px';
    sparkle.style.top = e.clientY + 'px';
    document.body.appendChild(sparkle);
    setTimeout(() => sparkle.remove(), 1500);
  }

  if (secretClicks < CLICKS_NEEDED) {
    const hints = ['\u2726', '\u2726 \u2726', '\u2726 \u2726 \u2726'];
    clickHint.textContent = hints[secretClicks - 1] || '';
    clickHint.style.color = '#3a2a1a';
    setTimeout(() => { clickHint.style.color = '#2a2a2a'; }, 800);
  }

  if (secretClicks >= CLICKS_NEEDED) {
    secretOverlay.classList.add('revealed');
    clickHint.textContent = '';
  }
});

secretClose.addEventListener('click', () => {
  secretOverlay.classList.remove('revealed');
  secretClicks = 0;
});

secretOverlay.addEventListener('click', (e) => {
  if (e.target === secretOverlay) {
    secretOverlay.classList.remove('revealed');
    secretClicks = 0;
  }
});
</script>
</body>
</html>